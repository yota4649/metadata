{"remainingRequest":"/space/metadata/ui/node_modules/babel-loader/lib/index.js!/space/metadata/ui/node_modules/cache-loader/dist/cjs.js??ref--0-0!/space/metadata/ui/node_modules/vue-loader/lib/index.js??vue-loader-options!/space/metadata/ui/src/views/DetailPage.vue?vue&type=script&lang=js&","dependencies":[{"path":"/space/metadata/ui/src/views/DetailPage.vue","mtime":1708045377310},{"path":"/space/metadata/ui/node_modules/cache-loader/dist/cjs.js","mtime":1707869666420},{"path":"/space/metadata/ui/node_modules/babel-loader/lib/index.js","mtime":1707869666788},{"path":"/space/metadata/ui/node_modules/cache-loader/dist/cjs.js","mtime":1707869666420},{"path":"/space/metadata/ui/node_modules/vue-loader/lib/index.js","mtime":1707869662322}],"contextDependencies":[],"result":["import _objectSpread from \"/space/metadata/ui/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es6.object.keys\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.array.iterator\";\nimport \"core-js/modules/es6.promise\";\nimport \"core-js/modules/es7.promise.finally\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport axios from \"axios\";\nimport mlSimilar from '@/components/ml-similar.vue';\nimport friendlyJson from '@/components/friendly-json.vue';\nimport friendlyXml from '@/components/friendly-xml.vue'; //import Pdf from 'vue-pdf';\n//import PDFViewer from 'pdf-viewer-vue';\n// OR THE FOLLOWING IMPORT FOR VUE 2\n\nimport PDFViewer from 'pdf-viewer-vue/dist/vue2-pdf-viewer';\nexport default {\n  name: 'DetailPage',\n  components: {\n    mlSimilar: mlSimilar,\n    friendlyJson: friendlyJson,\n    friendlyXml: friendlyXml //   PDFViewer,\n\n  },\n  props: ['type', 'id'],\n  data: function data() {\n    var self = this;\n    return {\n      metadata: {},\n      json: undefined,\n      raw: undefined,\n      tabIndex: 0,\n      checkedCollections: [],\n      addedCollections: [],\n      assetHref: \" \",\n      items: [{\n        text: \" \",\n        active: true\n      }]\n    };\n  },\n  computed: {\n    uri: function uri() {\n      return this.metadata.uri || '';\n    },\n    profile: function profile() {\n      return this.$store.state.auth.profile || {};\n    },\n    viewUri: function viewUri() {\n      return '/api/crud/' + this.type + '/' + this.id + '?';\n    },\n    downloadUri: function downloadUri() {\n      return this.viewUri + 'download=true';\n    },\n    handleDownload: function handleDownload() {\n      console.log('it is downloaded');\n      console.log(this.viewUri + 'download=true');\n      return this.viewUri + 'download=true';\n    }\n  },\n  mounted: function mounted() {\n    console.log('yota before update()');\n    this.update();\n  },\n  methods: {\n    update: function update() {\n      var self = this;\n      console.log('yota inside update()');\n      self.metadata = {};\n      self.json = undefined;\n      self.raw = undefined;\n      self.assetHref = \"\";\n      this.$store.dispatch('crud/' + self.type + '/view', {\n        id: self.id,\n        view: 'metadata'\n      }).then(function (response) {\n        console.log('yota  response.response is error');\n        console.log(response);\n\n        if (!response.isError) {\n          var metadata = JSON.parse(response.response);\n          var permissions = []; // flatten permissions for simplified display\n\n          metadata.permissions.forEach(function (p) {\n            p.capabilities.forEach(function (c) {\n              permissions.push(p['role-name'] + ':' + c);\n            });\n          });\n          metadata.permissions = permissions;\n\n          if (metadata.collections.length === 0) {\n            delete metadata.collections;\n          }\n\n          if (metadata.permissions.length === 0) {\n            delete metadata.permissions;\n          }\n\n          if (metadata.metadataValues && Object.keys(metadata.metadataValues).length === 0) {\n            delete metadata.metadataValues;\n          }\n\n          self.metadata = metadata;\n\n          if (metadata.format === 'json') {\n            self.$store.dispatch('crud/' + self.type + '/read', {\n              id: self.id\n            }).then(function (response) {\n              var jsonData = JSON.parse(response.response);\n\n              if (!response.isError) {\n                self.json = JSON.parse(response.response);\n                self.raw = JSON.stringify(self.json, null, 2);\n                self.assetHref = '/v1/documents?uri=' + jsonData.envelope.instance.Manual.filePath;\n              }\n            });\n          } else if (metadata.format === 'xml') {\n            self.$store.dispatch('crud/' + self.type + '/view', {\n              id: self.id,\n              view: 'indent'\n            }).then(function (response) {\n              if (!response.isError) {\n                self.raw = response.response;\n              }\n            });\n          }\n        } else {}\n      });\n      console.log('yota before getcollection()');\n      this.getCollection();\n      this.updateAccessCount();\n    },\n    getCollection: function getCollection() {\n      var self = this;\n      console.log(\"GET COLLECTION\");\n      axios.get(\"/v1/resources/partDetailsService\", {\n        params: {\n          \"rs:uri\": this.id\n        }\n      }).then(function (response) {\n        var content = response.data;\n\n        if (content) {\n          console.log(\"-----------------content.collections-----------------\");\n          console.log(content.collections);\n          self.items = content.collections;\n        }\n      }).catch(function (e) {\n        console.log(e);\n      });\n    },\n    updateAccessCount: function updateAccessCount() {\n      console.log(\"=====   updateAccessCount      ==== \");\n      var para = {\n        \"rs:uri\": encodeURIComponent(this.id)\n      };\n      axios.put(\"/v1/resources/updateAccess?rs:uri=\" + encodeURIComponent(this.id), para).then(function (response) {\n        console.log(\"++++++++ RESPONSE ++++++++\");\n        console.log(response.data);\n      }).catch(function (e) {\n        console.log(e);\n      });\n    },\n    deleteDoc: function deleteDoc() {\n      var self = this;\n\n      if (window.confirm('This will permanently delete ' + self.metadata.fileName + ', are you sure?')) {\n        var toast = self.$parent.$refs.toast; //    self.$store\n        //      .dispatch('crud/' + self.type + '/delete', { id: self.id })\n\n        var para = {\n          \"rs:uri\": encodeURIComponent(this.id)\n        };\n        axios.delete(\"/v1/resources/deleteBoth?rs:uri=\" + encodeURIComponent(this.id), para).then(function (response) {\n          if (response.isError) {\n            toast.showToast('Failed to delete the document', {\n              theme: 'error'\n            });\n          } else {\n            toast.showToast('Successfully deleted the document', {\n              theme: 'success'\n            });\n            self.$router.push({\n              name: self.previousRoute ? self.previousRoute.name : 'root.search',\n              params: _objectSpread({\n                refresh: true\n              }, self.previousRoute ? self.previousRoute.params : {})\n            });\n          }\n        });\n      }\n    },\n    buttonClickedRemove: function buttonClickedRemove() {\n      var _this = this;\n\n      window.alert(\"Collection Removed\");\n      console.log(this.checkedCollections);\n      var para = {};\n      para[\"rs.uri\"] = encodeURIComponent(this.id);\n      para[\"rs.op\"] = \"Remove\";\n      para[\"rs.cols\"] = this.checkedCollections;\n      axios.put(\"/v1/resources/updateCollections?rs:uri=\" + encodeURIComponent(this.id) + \"&rs:op=Remove\" + \"&rs:cols=\" + this.checkedCollections, para).then(function (response) {\n        console.log(\"++++++++ RESPONSE ++++++++\");\n        console.log(response.data);\n\n        _this.$router.go({\n          path: _this.$router.currentRoute.path,\n          force: true\n        }); //this.update();\n\n      }).catch(function (e) {\n        console.log(e);\n      });\n    },\n    buttonClickedAdd: function buttonClickedAdd() {\n      var _this2 = this;\n\n      window.alert(\"Collection Added\");\n      console.log(this.addedCollections);\n      var para = {};\n      para[\"rs.uri\"] = encodeURIComponent(this.id);\n      para[\"rs.op\"] = \"Add\";\n      para[\"rs.cols\"] = this.addedCollections;\n      axios.put(\"/v1/resources/updateCollections?rs:uri=\" + encodeURIComponent(this.id) + \"&rs:op=Add\" + \"&rs:cols=\" + this.addedCollections, para).then(function (response) {\n        console.log(\"++++++++ RESPONSE ++++++++\");\n        console.log(response.data);\n\n        _this2.$router.go({\n          path: _this2.$router.currentRoute.path,\n          force: true\n        }); // this.update();\n\n      }).catch(function (e) {\n        console.log(e);\n      });\n    }\n  },\n  watch: {\n    '$route.params': {\n      handler: function handler(params) {\n        if (params) {\n          this.update();\n        }\n      },\n      deep: true\n    }\n  }\n};",{"version":3,"sources":["DetailPage.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"row detail\">\n    <div class=\"col-sm-8 content-col\">\n      <h3>{{ metadata.fileName }} ({{ metadata.contentType }})</h3>\n      <div class=\"card\">\n        <b-tabs card no-fade v-model=\"tabIndex\">\n          <b-tab title=\"詳細\" active>\n            <dl class=\"row\">\n              <dt v-show=\"metadata.collections\" class=\"col-sm-2\">Collections</dt>\n              <dd v-show=\"metadata.collections\" class=\"col-sm-10\">\n                <span v-for=\"(c, $index) in metadata.collections\" :key=\"$index\">\n                  {{ c }}<span v-show=\"$index !== metadata.collections.length - 1\">, </span>\n                </span>\n              </dd>\n\n              <dt class=\"col-sm-2\">Content-Type</dt>\n              <dd class=\"col-sm-10\">{{ metadata.contentType }}</dd>\n\n              <dt class=\"col-sm-2\">File Name</dt>\n              <dd class=\"col-sm-10\">{{ metadata.fileName }}</dd>\n\n              <dt class=\"col-sm-2\">Format</dt>\n              <dd class=\"col-sm-10\">{{ metadata.format }}</dd>\n\n              <dt v-show=\"metadata.metadataValues\" class=\"col-sm-2\">Metadata</dt>\n              <dd v-show=\"metadata.metadataValues\" class=\"col-sm-10\">\n                <dl class=\"row\">\n                  <template v-for=\"(v, key, $index) in metadata.metadataValues\">\n                    <dt class=\"col-sm-2\" :key=\"$index\">{{ key }}</dt>\n                    <dd class=\"col-sm-10\" :key=\"$index\">{{ v }}</dd>\n                  </template>\n                </dl>\n              </dd>\n\n              <dt v-show=\"metadata.permissions\" class=\"col-sm-2\">Permissions</dt>\n              <dd v-show=\"metadata.permissions\" class=\"col-sm-10\">\n                <span v-for=\"(p, $index) in metadata.permissions\" :key=\"$index\">\n                  {{ p }}<span v-show=\"$index !== metadata.permissions.length - 1\">, </span>\n                </span>\n              </dd>\n\n              <dt class=\"col-sm-2\">Quality</dt>\n              <dd class=\"col-sm-10\">{{ metadata.quality }}</dd>\n\n              <dt class=\"col-sm-2\">Size</dt>\n              <dd class=\"col-sm-10\">{{ metadata.size }} bytes</dd>\n\n              <dt class=\"col-sm-2\">Uri</dt>\n              <dd class=\"col-sm-10\">{{ metadata.uri }}</dd>\n            </dl>\n\n            <h3>内容</h3>\n          <!-- \n            <pre>{{assetHref}}</pre>\n            <pre>{{ json.envelope.instance.Manual.filePath }}</pre>\n          -->\n\n              <view-binary :src=\"assetHref\" :type=\"metadata.contentType\" :title=\"metadata.fileName\">\n                <a slot=\"fallback\" class=\"btn btn-default\" :href=\"downloadUri\" target=\"_blank\" download>Download</a>\n              </view-binary>\n\n\n\n\n          </b-tab>\n          <b-tab title=\"プレビュー\">\n            <div v-if=\"metadata.format === 'json' && json\">\n              <friendly-json :json=\"json\"></friendly-json>\n            </div>\n            <div v-else-if=\"metadata.format === 'xml' && raw\">\n              <friendly-xml :xml=\"raw\"></friendly-xml>\n            </div>\n            <div v-else>\n              <view-binary :src=\"viewUri\" :type=\"metadata.contentType\" :title=\"metadata.fileName\">\n                <a slot=\"fallback\" class=\"btn btn-default\" :href=\"downloadUri\" target=\"_blank\" download>Download</a>\n              </view-binary>\n            </div>\n          </b-tab>\n          <b-tab title=\"オリジナルドキュメント\" v-show=\"raw\">\n            <pre>{{ raw }}</pre>\n          </b-tab>\n\n        </b-tabs>\n      </div>\n    </div>\n    <div class=\"col-sm-4 right-col\">\n      <div id=\"buttons-detail\">\n        <router-link tag=\"button\" class=\"btn btn-default\"\n                 :to=\"{ name: 'root.search' }\">検索</router-link>\n<!--\n        <router-link tag=\"button\" class=\"btn btn-primary\"\n                v-show=\"!profile.disallowUpdates\"\n                :to=\"{ name: 'root.edit', params: { id: id } }\">編集</router-link>\n-->\n        <button class=\"btn btn-primary\"\n                v-show=\"!profile.disallowUpdates\"\n                v-on:click.prevent=\"deleteDoc()\">削除</button>\n      </div>\n      <br>\n      <!-- show (links to) similar documents -->\n      <div class=\"card similar\">\n        <div class=\"card-header\">類似ファイル</div>\n        <div class=\"card-body\"> <ml-similar :uri=\"uri\" limit=\"5\"></ml-similar> </div>\n      </div>\n\n\n      <!-- collection add/remove -->\n\n      <div class=\"card collection\">\n        <div class=\"card-header\">タグ</div>\n        <div class=\"card-body\"> \n\n\n            <div id=\"app\">\n              <ul>\n                <div v-for=\"item in items\" :key=\"item\" >\n                  <input type=\"checkbox\" :id=\"item\" :value=\"item\" v-model=\"checkedCollections\" />\n                  <label :for=\"item\">&emsp;{{item}}</label>\n                </div>\n              </ul>\n            </div>\n            <div id=\"app\">\n              削除するタグ : {{ checkedCollections }}\n              <button class=\"btn btn-primary\" v-on:click=\"buttonClickedRemove\">削除実行</button>\n              <p/>\n              <input v-model=\"addedCollections\" placeholder=\"タグ名称\"><br/>\n              追加するタグ : {{ addedCollections }}\n              <button class=\"btn btn-primary\" v-on:click=\"buttonClickedAdd\">追加実行</button>\n              <p/>\n            </div>\n\n        </div>\n      </div>\n\n\n    </div>\n  </div>\n</template>\n\n<script>\nimport axios from \"axios\";\nimport mlSimilar from '@/components/ml-similar.vue';\nimport friendlyJson from '@/components/friendly-json.vue';\nimport friendlyXml from '@/components/friendly-xml.vue';\n\n//import Pdf from 'vue-pdf';\n//import PDFViewer from 'pdf-viewer-vue';\n\n// OR THE FOLLOWING IMPORT FOR VUE 2\nimport PDFViewer from 'pdf-viewer-vue/dist/vue2-pdf-viewer';\n\nexport default {\n  name: 'DetailPage',\n  components: {\n    mlSimilar,\n    friendlyJson,\n    friendlyXml,\n //   PDFViewer,\n  },\n  props: ['type', 'id'],\n  data() {\n    const self = this;\n    return {\n      metadata: {},\n      json: undefined,\n      raw: undefined,\n      tabIndex: 0,\n      checkedCollections: [],\n      addedCollections: [],\n      assetHref: \" \",\n\n      items:[\n        {\n          text: \" \",\n          active: true,\n        },\n      ],\n\n    };\n  },\n  computed: {\n    uri() {\n      return this.metadata.uri || '';\n    },\n    profile() {\n      return this.$store.state.auth.profile || {};\n    },\n    viewUri() {\n      return '/api/crud/' + this.type + '/' + this.id + '?';\n    },\n    downloadUri() {\n      return this.viewUri + 'download=true';\n    },\n    handleDownload() {\n      console.log('it is downloaded');\n      console.log(this.viewUri + 'download=true');\n      return this.viewUri + 'download=true';\n    }\n  },\n  mounted() {\n    console.log('yota before update()');\n    this.update();\n  },\n  methods: {\n    update() {\n      const self = this;\n\n      console.log('yota inside update()');\n      self.metadata = {};\n      self.json = undefined;\n      self.raw = undefined;\n      self.assetHref = \"\";\n      this.$store\n        .dispatch('crud/' + self.type + '/view', { id: self.id, view: 'metadata' })\n        .then(function(response) {\n            console.log('yota  response.response is error');\n            console.log(response);\n          if (!response.isError) {\n            var metadata = JSON.parse(response.response);\n            var permissions = [];\n            // flatten permissions for simplified display\n            metadata.permissions.forEach(function(p) {\n              p.capabilities.forEach(function(c) {\n                permissions.push(p['role-name'] + ':' + c);\n              });\n            });\n            metadata.permissions = permissions;\n            if (metadata.collections.length === 0) {\n              delete metadata.collections;\n            }\n            if (metadata.permissions.length === 0) {\n              delete metadata.permissions;\n            }\n            if ( metadata.metadataValues && Object.keys(metadata.metadataValues).length === 0) {\n              delete metadata.metadataValues;\n            }\n            self.metadata = metadata;\n\n            if (metadata.format === 'json') {\n              self.$store\n                .dispatch('crud/' + self.type + '/read', { id: self.id })\n                .then(function(response) {\n\n                  let jsonData = JSON.parse(response.response);\n\n                  if (!response.isError) {\n                    self.json = JSON.parse(response.response);\n                    self.raw = JSON.stringify(self.json, null, 2);\n                    self.assetHref = '/v1/documents?uri='+ jsonData.envelope.instance.Manual.filePath;\n                  }\n                });\n            } else if (metadata.format === 'xml') {\n              self.$store.dispatch('crud/' + self.type + '/view', { id: self.id, view: 'indent' })\n                .then(function(response) {\n                  if (!response.isError) { self.raw = response.response; }\n                });\n            }\n          }\n\t  else {\n          }\n\n        }\n       );\n       console.log('yota before getcollection()');\n       this.getCollection();\n       this.updateAccessCount();\n    },\n\n\n    getCollection(){\n      const self = this;\n      console.log(\"GET COLLECTION\");\n     axios\n        .get(\"/v1/resources/partDetailsService\", {\n          params: {\n            \"rs:uri\": this.id,\n          },\n        })\n        .then((response) => {\n          var content = response.data;\n          if (content){\n            console.log(\"-----------------content.collections-----------------\");\n            console.log(content.collections);\n            self.items = content.collections;\n          }\n        })\n        .catch((e) => {\n          console.log(e);\n        });\n\n\n    },\n    updateAccessCount() {\n      console.log(\"=====   updateAccessCount      ==== \");\n\n      var para = {\"rs:uri\": encodeURIComponent(this.id)};\n      axios\n        .put(\"/v1/resources/updateAccess?rs:uri=\"+encodeURIComponent(this.id), para)\n        .then((response) => {\n          console.log(\"++++++++ RESPONSE ++++++++\")\n          console.log(response.data);\n        })\n        .catch((e) => {\n          console.log(e);\n        });\n    },\n    deleteDoc() {\n      const self = this;\n      if (\n        window.confirm(\n          'This will permanently delete ' +\n            self.metadata.fileName +\n            ', are you sure?'\n        )\n      ) {\n        const toast = self.$parent.$refs.toast;\n    //    self.$store\n    //      .dispatch('crud/' + self.type + '/delete', { id: self.id })\n\n        var para = {\"rs:uri\": encodeURIComponent(this.id)};\n        axios\n          .delete(\"/v1/resources/deleteBoth?rs:uri=\"+encodeURIComponent(this.id), para)\n          .then(function(response) {\n            if (response.isError) {\n              toast.showToast('Failed to delete the document', {\n                theme: 'error'\n              });\n            } else {\n              toast.showToast('Successfully deleted the document', {\n                theme: 'success'\n              });\n              self.$router.push({\n                name: self.previousRoute\n                  ? self.previousRoute.name\n                  : 'root.search',\n                params: {\n                  refresh: true,\n                  ...(self.previousRoute ? self.previousRoute.params : {})\n                }\n              });\n            }\n          });\n      }\n    },\n\n    buttonClickedRemove(){\n        window.alert(\"Collection Removed\");\n        console.log(this.checkedCollections);\n        var para = {};\n        para[\"rs.uri\"] = encodeURIComponent(this.id);\n        para[\"rs.op\"] = \"Remove\";\n        para[\"rs.cols\"] = this.checkedCollections;\n\n        axios\n          .put(\"/v1/resources/updateCollections?rs:uri=\"+encodeURIComponent(this.id)+\"&rs:op=Remove\"+\"&rs:cols=\"+this.checkedCollections, para)\n          .then((response) => {\n             console.log(\"++++++++ RESPONSE ++++++++\")\n             console.log(response.data);\nthis.$router.go({path: this.$router.currentRoute.path, force: true});\n             //this.update();\n          })\n          .catch((e) => {\n              console.log(e);\n          })\n    },\n    buttonClickedAdd(){\n        window.alert(\"Collection Added\");\n        console.log(this.addedCollections);\n        var para = {};\n        para[\"rs.uri\"] = encodeURIComponent(this.id);\n        para[\"rs.op\"] = \"Add\";\n        para[\"rs.cols\"] = this.addedCollections;\n\n        axios\n          .put(\"/v1/resources/updateCollections?rs:uri=\"+encodeURIComponent(this.id)+\"&rs:op=Add\"+\"&rs:cols=\"+this.addedCollections, para)\n          .then((response) => {\n             console.log(\"++++++++ RESPONSE ++++++++\")\n             console.log(response.data);\nthis.$router.go({path: this.$router.currentRoute.path, force: true});\n            // this.update();\n          })\n          .catch((e) => {\n              console.log(e);\n          });\n    },\n\n\n  },\n\n  watch: {\n    '$route.params': {\n      handler(params) {\n        if (params) {\n          this.update();\n        }\n      },\n      deep: true\n    }\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\nview-binary {\n  display: block;\n  height: 600px;\n}\n</style>\n"],"sourceRoot":"src/views"}]}